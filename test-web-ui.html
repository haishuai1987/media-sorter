<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web UI æµ‹è¯• - v1.8.0</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            margin: 0;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        }
        h1 {
            color: #333;
            margin-bottom: 30px;
            text-align: center;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        .test-section h2 {
            margin: 0 0 15px 0;
            color: #667eea;
            font-size: 18px;
        }
        button {
            padding: 12px 24px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            margin-right: 10px;
            margin-bottom: 10px;
            transition: all 0.2s;
        }
        button:hover {
            background: #5568d3;
            transform: translateY(-2px);
        }
        .output {
            margin-top: 15px;
            padding: 15px;
            background: white;
            border-radius: 6px;
            border: 1px solid #e0e0e0;
            font-family: monospace;
            font-size: 13px;
            max-height: 300px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¨ Web UI æµ‹è¯• (v1.8.0)</h1>

        <!-- Toasté€šçŸ¥æµ‹è¯• -->
        <div class="test-section">
            <h2>ğŸ“¢ Toasté€šçŸ¥ç³»ç»Ÿ</h2>
            <button onclick="testToastSuccess()">âœ… æˆåŠŸæç¤º</button>
            <button onclick="testToastError()">âŒ é”™è¯¯æç¤º</button>
            <button onclick="testToastWarning()">âš ï¸ è­¦å‘Šæç¤º</button>
            <button onclick="testToastInfo()">â„¹ï¸ ä¿¡æ¯æç¤º</button>
            <button onclick="testToastFromError()">ğŸ›¡ï¸ é”™è¯¯å¯¹è±¡æç¤º</button>
        </div>

        <!-- é”™è¯¯ç»Ÿè®¡æµ‹è¯• -->
        <div class="test-section">
            <h2>ğŸ“Š é”™è¯¯ç»Ÿè®¡é¢æ¿</h2>
            <button onclick="openErrorStats()">æ‰“å¼€é”™è¯¯ç»Ÿè®¡</button>
            <button onclick="simulateSuccess()">æ¨¡æ‹ŸæˆåŠŸæ“ä½œ</button>
            <button onclick="simulateError()">æ¨¡æ‹Ÿé”™è¯¯æ“ä½œ</button>
            <div class="output" id="statsOutput">ç‚¹å‡»æŒ‰é’®æµ‹è¯•...</div>
        </div>

        <!-- APIæµ‹è¯• -->
        <div class="test-section">
            <h2>ğŸ”Œ APIç«¯ç‚¹æµ‹è¯•</h2>
            <button onclick="testErrorStatsAPI()">æµ‹è¯• /api/error-stats</button>
            <button onclick="testHistoryAPI()">æµ‹è¯• /api/operation-history</button>
            <div class="output" id="apiOutput">ç‚¹å‡»æŒ‰é’®æµ‹è¯•...</div>
        </div>
    </div>

    <!-- å¼•å…¥Toastå’ŒErrorStats -->
    <script src="/toast.js"></script>
    <script src="/error-stats.js"></script>

    <script>
        // Toastæµ‹è¯•
        function testToastSuccess() {
            toast.success('æ“ä½œæˆåŠŸï¼æ–‡ä»¶å·²æ•´ç†å®Œæˆ');
        }

        function testToastError() {
            toast.error('æ“ä½œå¤±è´¥ï¼šç½‘ç»œè¿æ¥è¶…æ—¶');
        }

        function testToastWarning() {
            toast.warning('è­¦å‘Šï¼šç£ç›˜ç©ºé—´ä¸è¶³ï¼Œè¯·åŠæ—¶æ¸…ç†');
        }

        function testToastInfo() {
            toast.info('æ­£åœ¨æ‰«ææ–‡ä»¶ï¼Œè¯·ç¨å€™...');
        }

        function testToastFromError() {
            const error = new Error('Connection timeout');
            toast.showError(error, 'æ–‡ä»¶ä¸Šä¼ ');
        }

        // é”™è¯¯ç»Ÿè®¡æµ‹è¯•
        function openErrorStats() {
            errorStatsPanel.open();
        }

        function simulateSuccess() {
            fetch('/api/error-stats', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({})
            }).then(r => r.json()).then(data => {
                document.getElementById('statsOutput').textContent = 
                    'æˆåŠŸæ“ä½œå·²è®°å½•\n' + JSON.stringify(data, null, 2);
                toast.success('æˆåŠŸæ“ä½œå·²è®°å½•');
            });
        }

        function simulateError() {
            fetch('/api/error-stats', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({})
            }).then(r => r.json()).then(data => {
                document.getElementById('statsOutput').textContent = 
                    'é”™è¯¯æ“ä½œå·²è®°å½•\n' + JSON.stringify(data, null, 2);
                toast.error('é”™è¯¯æ“ä½œå·²è®°å½•');
            });
        }

        // APIæµ‹è¯•
        async function testErrorStatsAPI() {
            try {
                const response = await fetch('/api/error-stats', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({})
                });
                const data = await response.json();
                document.getElementById('apiOutput').textContent = 
                    'GET /api/error-stats\n\n' + JSON.stringify(data, null, 2);
                toast.success('APIè°ƒç”¨æˆåŠŸ');
            } catch (error) {
                document.getElementById('apiOutput').textContent = 
                    'Error: ' + error.message;
                toast.error('APIè°ƒç”¨å¤±è´¥');
            }
        }

        async function testHistoryAPI() {
            try {
                const response = await fetch('/api/operation-history', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({})
                });
                const data = await response.json();
                document.getElementById('apiOutput').textContent = 
                    'GET /api/operation-history\n\n' + JSON.stringify(data, null, 2);
                toast.success('APIè°ƒç”¨æˆåŠŸ');
            } catch (error) {
                document.getElementById('apiOutput').textContent = 
                    'Error: ' + error.message;
                toast.error('APIè°ƒç”¨å¤±è´¥');
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆæç¤º
        window.addEventListener('load', () => {
            toast.info('æµ‹è¯•é¡µé¢åŠ è½½å®Œæˆï¼Œå¯ä»¥å¼€å§‹æµ‹è¯•äº†ï¼');
        });
    </script>
</body>
</html>
