# Media Renamer v2.8.0 开发路线图

## 📋 版本信息

**版本号**: v2.8.0  
**代号**: Enhanced Experience  
**计划开始**: 2025-10-23  
**预计完成**: 2025-10-23  
**开发时间**: 3-4 小时

---

## 🎯 版本目标

**主题**: 增强用户体验和实用功能

在 v2.7.0 完成体验优化的基础上，v2.8.0 将进一步提升应用的实用性和交互体验。

---

## 🚀 核心功能

### 1. 文件上传进度显示 📊
**优先级**: 高  
**预计时间**: 1 小时

#### 功能描述
- 实时显示文件处理进度
- 百分比进度条
- 当前处理文件名
- 预计剩余时间
- 处理速度显示

#### 技术实现
- WebSocket 实时通信
- 进度条组件
- 后端进度推送
- 前端实时更新

#### 用户价值
- 了解处理进度
- 预估完成时间
- 提升等待体验
- 减少焦虑感

---

### 2. 自动跟随系统主题 🌓
**优先级**: 高  
**预计时间**: 0.5 小时

#### 功能描述
- 检测系统主题设置
- 自动切换应用主题
- 支持手动覆盖
- 实时响应系统变化

#### 技术实现
- `window.matchMedia` API
- 主题变化监听
- 优先级管理
- 状态持久化

#### 用户价值
- 无缝系统集成
- 自动适应环境
- 减少手动操作
- 统一视觉体验

---

### 3. 批量操作撤销/重做 ↩️
**优先级**: 中  
**预计时间**: 1.5 小时

#### 功能描述
- 撤销最近操作（Ctrl+Z）
- 重做已撤销操作（Ctrl+Y）
- 操作历史栈
- 最多保存 20 步
- 显示可撤销步数

#### 技术实现
- 命令模式设计
- 操作历史栈
- 状态快照
- 快捷键绑定

#### 用户价值
- 容错能力提升
- 操作更自信
- 减少误操作损失
- 提升工作效率

---

### 4. 拖拽排序 🔄
**优先级**: 中  
**预计时间**: 1 小时

#### 功能描述
- 文件列表拖拽排序
- 视觉反馈
- 自动保存顺序
- 批量移动支持

#### 技术实现
- HTML5 拖拽 API
- 拖拽事件处理
- 列表重排序
- 状态同步

#### 用户价值
- 灵活调整顺序
- 直观的操作方式
- 自定义处理顺序
- 提升控制感

---

## 📊 开发计划

### 第一阶段：进度显示（1 小时）
- [ ] 后端进度推送机制
- [ ] WebSocket 连接
- [ ] 进度条组件
- [ ] 实时更新逻辑

### 第二阶段：系统主题（0.5 小时）
- [ ] 系统主题检测
- [ ] 自动切换逻辑
- [ ] 优先级管理
- [ ] 实时监听

### 第三阶段：撤销重做（1.5 小时）
- [ ] 命令模式实现
- [ ] 操作历史栈
- [ ] 快捷键绑定
- [ ] UI 状态更新

### 第四阶段：拖拽排序（1 小时）
- [ ] 拖拽事件处理
- [ ] 视觉反馈
- [ ] 列表重排序
- [ ] 状态持久化

---

## 🎨 UI/UX 改进

### 进度显示
```
┌─────────────────────────────────────┐
│ 正在处理: 文件名.mp4                │
│ ████████████░░░░░░░░░░ 60%          │
│ 已完成: 6/10 | 剩余: ~2分钟         │
└─────────────────────────────────────┘
```

### 撤销/重做提示
```
┌─────────────────────────────────────┐
│ ↩️ 已撤销: 删除 3 个文件            │
│ [撤销] [重做]                       │
└─────────────────────────────────────┘
```

### 拖拽排序
```
┌─────────────────────────────────────┐
│ ⋮⋮ 文件1.mp4          [拖动我]     │
│ ⋮⋮ 文件2.mp4                        │
│ ⋮⋮ 文件3.mp4                        │
└─────────────────────────────────────┘
```

---

## 🔧 技术架构

### 后端新增
```python
# WebSocket 支持
from flask_socketio import SocketIO, emit

# 进度管理器
class ProgressManager:
    def update_progress(self, current, total)
    def get_progress(self)
    def reset_progress(self)

# 操作历史管理
class OperationHistory:
    def push(self, operation)
    def undo(self)
    def redo(self)
    def can_undo(self)
    def can_redo(self)
```

### 前端新增
```javascript
// WebSocket 客户端
class ProgressSocket {
    connect()
    onProgress(callback)
    disconnect()
}

// 进度条组件
class ProgressBar {
    update(current, total)
    setMessage(message)
    show() / hide()
}

// 撤销重做管理
class UndoRedoManager {
    execute(command)
    undo()
    redo()
    canUndo() / canRedo()
}

// 拖拽排序
class DragSortable {
    enable()
    disable()
    onSort(callback)
}
```

---

## 📦 依赖更新

### 新增依赖
```
flask-socketio==5.3.5    # WebSocket 支持
python-socketio==5.10.0  # Socket.IO 服务端
```

### 前端库
```
无需新增，使用原生 API
```

---

## 🎯 成功指标

### 功能完整度
- [ ] 4 个核心功能全部实现
- [ ] 所有功能测试通过
- [ ] 文档完整

### 用户体验
- [ ] 进度显示流畅（< 100ms 延迟）
- [ ] 主题切换无感知
- [ ] 撤销重做响应快速
- [ ] 拖拽排序顺滑

### 代码质量
- [ ] 代码规范统一
- [ ] 注释完整
- [ ] 无明显 bug
- [ ] 性能优化

---

## 🔄 与 v2.7.0 的关系

### 继承功能
- ✅ 主题系统（扩展为自动跟随）
- ✅ 快捷键系统（新增撤销重做）
- ✅ 多语言支持（新增翻译）
- ✅ 所有现有功能

### 新增功能
- 🆕 进度显示
- 🆕 系统主题跟随
- 🆕 撤销重做
- 🆕 拖拽排序

---

## 📈 预期成果

### 代码统计
```
新增代码: 800+ 行
新增文件: 3 个
新增 API: 5 个
新增功能: 4 个
```

### 功能统计
```
总功能数: 20 个
核心功能: 12 个
增强功能: 8 个
```

---

## 🎊 版本亮点

1. **实时进度** - 让用户随时了解处理状态
2. **智能主题** - 自动适应系统环境
3. **容错机制** - 撤销重做提升安全感
4. **灵活排序** - 拖拽操作更直观

---

## 📝 后续版本预告

### v2.9.0（中期）
- WebSocket 全面应用
- 实时协作功能
- 用户认证系统
- 权限管理

### v3.0.0（长期）
- 微服务架构
- 分布式处理
- 云存储集成
- AI 智能识别

---

## 🔗 相关文档

- [v2.7.0 更新日志](CHANGELOG-v2.7.0.md)
- [开发总结 v2.5-v2.7](DEVELOPMENT-SUMMARY-v2.5-v2.7.md)
- [项目成就 v2.7.0](PROJECT-ACHIEVEMENT-v2.7.0.md)

---

**创建时间**: 2025-10-23  
**版本**: v2.8.0 规划  
**状态**: 📋 规划中
