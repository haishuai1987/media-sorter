# 常见问题 (FAQ)

## 目录
- [安装问题](#安装问题)
- [配置问题](#配置问题)
- [使用问题](#使用问题)
- [性能问题](#性能问题)
- [错误处理](#错误处理)

---

## 安装问题

### Q: 需要安装哪些依赖？
**A**: 不需要安装任何外部依赖，所有依赖都是Python标准库：
- os, json, re
- urllib, http.server
- time, functools

### Q: Python版本要求？
**A**: Python 3.6或更高版本。

检查版本：
```bash
python3 --version
```

### Q: 如何在Ubuntu上安装Python 3？
**A**:
```bash
sudo apt update
sudo apt install python3 python3-pip
```

### Q: 如何在CentOS上安装Python 3？
**A**:
```bash
sudo yum install python3 python3-pip
```

### Q: 端口8090被占用怎么办？
**A**: 修改 `app.py` 中的端口：
```python
PORT = 8091  # 改为其他端口
```

---

## 配置问题

### Q: 如何获取TMDB API Key？
**A**:
1. 访问 https://www.themoviedb.org/
2. 注册/登录账号
3. 进入 Settings → API
4. 申请API Key（免费）
5. 复制API Key到设置中

### Q: 如何获取豆瓣Cookie？
**A**:
1. 浏览器登录 https://movie.douban.com/
2. 按F12打开开发者工具
3. 切换到Network标签
4. 刷新页面
5. 点击任意请求
6. 在Headers中找到Cookie
7. 复制完整Cookie到设置中

### Q: 豆瓣Cookie多久过期？
**A**: 通常1-3个月，过期后重新获取即可。

### Q: TMDB是否需要代理？
**A**: 国内访问TMDB可能需要代理，豆瓣不需要。

### Q: 支持哪些代理类型？
**A**: 支持HTTP/HTTPS和SOCKS5代理。

### Q: 配置文件保存在哪里？
**A**: `~/.media-renamer/config.json`

---

## 使用问题

### Q: 支持哪些文件格式？
**A**:
- **视频**: mp4, mkv, avi, mov, ts, iso, rmvb, mpeg, mpg, wmv, 3gp, asf, m4v, flv, m2ts, tp, f4v
- **字幕**: srt, ass, ssa

### Q: 如何处理特殊字符？
**A**: 系统自动清理非法字符（`<>:"/\|?*`），确保跨平台兼容。

### Q: 文件名太长怎么办？
**A**: 系统自动限制文件名长度为255字节（大多数文件系统的限制）。

### Q: 如何撤销操作？
**A**: 
- 建议操作前备份重要文件
- 使用NAS的快照功能
- 或手动备份配置

### Q: 可以处理多少文件？
**A**: 
- 建议每次50-100个文件
- 大文件（>10GB）单独处理
- 可以多次运行

### Q: 如何只处理新文件？
**A**: 使用"跳过"策略，系统会跳过已存在的文件。

### Q: 字幕文件会一起处理吗？
**A**: 是的，字幕文件会自动跟随视频文件一起重命名和移动。

### Q: 如何保留多个版本？
**A**: 选择"保留两个"策略，新文件会添加.v1后缀。

---

## 性能问题

### Q: 处理速度慢怎么办？
**A**:
1. 减少单次处理文件数量
2. 检查网络连接
3. 增加重试延迟：
```python
# 编辑 app.py
NETWORK_RETRY_COUNT = 5
NETWORK_RETRY_DELAY = 3
NETWORK_OP_DELAY = 2.0
```

### Q: 网盘操作很慢？
**A**: 
- 这是正常现象
- 系统已针对网盘优化
- 增加了重试机制和延迟
- 建议使用有线连接

### Q: TMDB查询超时？
**A**:
1. 检查代理是否正常
2. 检查API Key是否正确
3. 检查网络连接
4. 增加重试次数

### Q: 豆瓣查询失败？
**A**:
1. 检查Cookie是否过期
2. 重新获取Cookie
3. 检查网络连接

### Q: 如何提高处理速度？
**A**:
1. 使用SSD存储
2. 使用有线网络
3. 减少单次处理文件数
4. 使用本地文件系统（非网络）

---

## 错误处理

### Q: 提示"权限不足"？
**A**:
```bash
# 修改所有者
sudo chown -R $USER:$USER /path/to/media

# 修改权限
sudo chmod -R 755 /path/to/media

# 检查配置目录
chmod 755 ~/.media-renamer
chmod 644 ~/.media-renamer/config.json
```

### Q: 提示"路径不存在"？
**A**:
1. 检查路径是否正确
2. 检查路径是否有权限
3. 检查网络挂载是否正常

### Q: 提示"文件系统操作失败"？
**A**:
1. 检查磁盘空间
2. 检查文件系统权限
3. 检查网络连接（如果是网络文件系统）
4. 查看详细错误日志

### Q: 提示"API Key无效"？
**A**:
1. 检查API Key是否正确
2. 检查是否有多余的空格
3. 重新申请API Key

### Q: 提示"Cookie过期"？
**A**:
1. 重新登录豆瓣
2. 获取新的Cookie
3. 在设置中更新

### Q: 文件移动后找不到？
**A**:
1. 检查输出目录配置
2. 查看"整理详情"中的日志
3. 检查是否有冲突被跳过

### Q: 部分文件没有处理？
**A**:
1. 检查文件格式是否支持
2. 查看日志了解原因
3. 检查是否有权限问题

---

## 系统相关

### Q: 支持哪些操作系统？
**A**:
- Ubuntu 20.04+
- Debian 11+
- CentOS 7+
- Synology DSM 7+
- QNAP QTS 5+
- TrueNAS CORE/SCALE
- Unraid 6+

### Q: 支持哪些文件系统？
**A**:
- ext4, btrfs, ZFS（推荐）
- XFS, NTFS, exFAT
- NFS, SMB/CIFS（网络）

### Q: 如何在Synology上部署？
**A**: 参考 [部署指南](部署指南.md#synology-dsm)

### Q: 如何在QNAP上部署？
**A**: 参考 [部署指南](部署指南.md#qnap-qts)

### Q: 如何使用Docker部署？
**A**: 参考 [部署指南](部署指南.md#docker部署)

### Q: 如何设置开机自启？
**A**: 参考 [部署指南](部署指南.md#系统服务)

---

## 网络相关

### Q: 无法访问Web界面？
**A**:
```bash
# 检查服务是否运行
ps aux | grep app.py

# 检查端口
netstat -tuln | grep 8090

# 检查防火墙
sudo ufw status
```

### Q: 局域网无法访问？
**A**:
1. 检查防火墙设置
2. 确认使用正确的IP地址
3. 检查端口是否开放

### Q: 如何只允许局域网访问？
**A**:
```bash
sudo ufw allow from 192.168.1.0/24 to any port 8090
```

### Q: 如何配置反向代理？
**A**: 参考 [部署指南](部署指南.md#反向代理)

---

## 数据安全

### Q: 如何备份配置？
**A**:
```bash
cp ~/.media-renamer/config.json ~/config.backup.json
```

### Q: 如何备份媒体库？
**A**:
1. 使用NAS的快照功能
2. 使用rsync备份
3. 使用云存储备份

### Q: 操作是否可逆？
**A**: 
- 文件移动和重命名操作不可自动撤销
- 建议操作前备份
- 或使用NAS快照功能

### Q: 如何防止误操作？
**A**:
1. 首次使用小批量测试
2. 使用"跳过"策略
3. 定期备份
4. 使用快照功能

---

## 其他问题

### Q: 如何更新程序？
**A**:
```bash
git pull
sudo systemctl restart media-renamer  # 如果使用systemd
```

### Q: 如何查看日志？
**A**:
```bash
# systemd服务
sudo journalctl -u media-renamer -f

# 直接运行
# 查看终端输出
```

### Q: 如何贡献代码？
**A**: 
1. Fork项目
2. 创建分支
3. 提交PR

### Q: 如何报告Bug？
**A**: 
在GitHub上提交Issue，包含：
1. 系统版本
2. Python版本
3. 错误日志
4. 复现步骤

### Q: 是否支持其他语言？
**A**: 目前仅支持中文界面，欢迎贡献翻译。

### Q: 是否有移动端App？
**A**: 暂无，但Web界面支持移动端浏览器访问。

### Q: 是否支持批量编辑？
**A**: 暂不支持，建议使用配置文件批量处理。

---

## 获取更多帮助

如果以上答案无法解决你的问题：

1. 查看 [使用指南](使用指南.md)
2. 查看 [部署指南](部署指南.md)
3. 查看 [功能说明](功能说明.md)
4. 在GitHub提交Issue
5. 加入社区讨论

---

**持续更新中，欢迎提出问题！**
