# æœ€ç»ˆéƒ¨ç½²æ£€æŸ¥æ¸…å•

## âœ… å·²å®Œæˆçš„ä¼˜åŒ–

### 1. æ ¸å¿ƒåŠŸèƒ½
- âœ… æ–‡ä»¶åæ¸…ç†ï¼ˆè·¨æ–‡ä»¶ç³»ç»Ÿå…¼å®¹ï¼‰
- âœ… æƒé™æ£€æŸ¥
- âœ… ç½‘ç»œæ“ä½œé‡è¯•æœºåˆ¶
- âœ… å®‰å…¨çš„æ–‡ä»¶æ“ä½œï¼ˆsafe_rename, safe_removeï¼‰
- âœ… ç¬¦å·é“¾æ¥è§£æ
- âœ… æ–‡ä»¶ç³»ç»Ÿç±»å‹æ£€æµ‹

### 2. é…ç½®ç®¡ç†
- âœ… ç”¨æˆ·é…ç½®æ–‡ä»¶æ”¯æŒï¼ˆ~/.media-renamer/config.jsonï¼‰
- âœ… è®¾ç½®ç•Œé¢ï¼ˆWeb UIï¼‰
- âœ… APIå¯†é’¥ç‹¬ç«‹é…ç½®
- âœ… ä»£ç†æ”¯æŒï¼ˆHTTP/SOCKS5ï¼‰

### 3. ç•Œé¢ä¼˜åŒ–
- âœ… æ•´ç†è¯¦æƒ…å¼¹çª—
- âœ… å®æ—¶è¿›åº¦æ˜¾ç¤º
- âœ… 8æ­¥è¿›åº¦è·Ÿè¸ª
- âœ… å®æ—¶æ—¥å¿—
- âœ… å®Œæˆé€šçŸ¥
- âœ… è®¾ç½®æŒ‰é’®

### 4. éƒ¨ç½²æ”¯æŒ
- âœ… è‡ªåŠ¨å®‰è£…è„šæœ¬ï¼ˆinstall.shï¼‰
- âœ… Dockeræ”¯æŒï¼ˆDockerfile + docker-compose.ymlï¼‰
- âœ… systemdæœåŠ¡æ”¯æŒ
- âœ… NASç³»ç»Ÿéƒ¨ç½²æŒ‡å—

### 5. æ–‡æ¡£
- âœ… Linux/NASä¼˜åŒ–æ–¹æ¡ˆ
- âœ… NASéƒ¨ç½²æŒ‡å—
- âœ… å¿«é€Ÿå¼€å§‹æŒ‡å—
- âœ… è®¾ç½®åŠŸèƒ½è¯´æ˜
- âœ… æ›´æ–°æ—¥å¿—

---

## ğŸ” æœ€ç»ˆæ£€æŸ¥é¡¹

### ç³»ç»Ÿå…¼å®¹æ€§

#### Pythonç‰ˆæœ¬
```bash
# æ£€æŸ¥Pythonç‰ˆæœ¬
python3 --version
# éœ€è¦ >= 3.6
```

#### ä¾èµ–æ£€æŸ¥
```python
# æ‰€æœ‰ä¾èµ–éƒ½æ˜¯Pythonæ ‡å‡†åº“
import os
import json
import re
import urllib.request
import time
from functools import wraps
from http.server import HTTPServer, SimpleHTTPRequestHandler
```

#### æ–‡ä»¶ç³»ç»Ÿæƒé™
```bash
# æ£€æŸ¥é…ç½®ç›®å½•æƒé™
ls -la ~/.media-renamer/
# åº”è¯¥æœ‰è¯»å†™æƒé™

# æ£€æŸ¥åª’ä½“ç›®å½•æƒé™
ls -la /path/to/media/
# åº”è¯¥æœ‰è¯»å†™æƒé™
```

### ç½‘ç»œé…ç½®

#### ç«¯å£æ£€æŸ¥
```bash
# æ£€æŸ¥ç«¯å£8090æ˜¯å¦è¢«å ç”¨
netstat -tuln | grep 8090
# æˆ–
ss -tuln | grep 8090
```

#### é˜²ç«å¢™é…ç½®
```bash
# Ubuntu/Debian
sudo ufw allow 8090

# CentOS/RHEL
sudo firewall-cmd --add-port=8090/tcp --permanent
sudo firewall-cmd --reload
```

### é…ç½®æ–‡ä»¶

#### é»˜è®¤é…ç½®ä½ç½®
```
~/.media-renamer/config.json
```

#### é…ç½®æ–‡ä»¶æ ¼å¼
```json
{
  "tmdb_api_key": "your-key",
  "tmdb_proxy": "http://proxy:port",
  "tmdb_proxy_type": "http",
  "douban_cookie": "your-cookie"
}
```

---

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### æ–¹æ³•1: è‡ªåŠ¨å®‰è£…ï¼ˆæ¨èï¼‰

```bash
# 1. ä¸‹è½½é¡¹ç›®
git clone https://github.com/your-repo/media-renamer.git
cd media-renamer

# 2. è¿è¡Œå®‰è£…è„šæœ¬
chmod +x install.sh
./install.sh

# 3. é…ç½®APIå¯†é’¥
# è®¿é—® http://localhost:8090
# ç‚¹å‡»"è®¾ç½®"æŒ‰é’®é…ç½®

# 4. å¯åŠ¨æœåŠ¡
python3 app.py
```

### æ–¹æ³•2: Dockeréƒ¨ç½²

```bash
# 1. ä¿®æ”¹docker-compose.yml
nano docker-compose.yml
# ä¿®æ”¹volumesè·¯å¾„

# 2. å¯åŠ¨å®¹å™¨
docker-compose up -d

# 3. æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# 4. é…ç½®APIå¯†é’¥
# è®¿é—® http://localhost:8090
# ç‚¹å‡»"è®¾ç½®"æŒ‰é’®é…ç½®
```

### æ–¹æ³•3: systemdæœåŠ¡

```bash
# 1. åˆ›å»ºæœåŠ¡æ–‡ä»¶
sudo nano /etc/systemd/system/media-renamer.service

# 2. æ·»åŠ å†…å®¹ï¼ˆè§ä¸‹æ–¹ï¼‰

# 3. å¯ç”¨æœåŠ¡
sudo systemctl daemon-reload
sudo systemctl enable media-renamer
sudo systemctl start media-renamer

# 4. æ£€æŸ¥çŠ¶æ€
sudo systemctl status media-renamer
```

#### systemdæœåŠ¡æ–‡ä»¶
```ini
[Unit]
Description=Media Renamer Service
After=network.target

[Service]
Type=simple
User=your-user
WorkingDirectory=/path/to/media-renamer
ExecStart=/usr/bin/python3 /path/to/media-renamer/app.py
Restart=on-failure
RestartSec=10
StandardOutput=journal
StandardError=journal

[Install]
WantedBy=multi-user.target
```

---

## ğŸ§ª æµ‹è¯•æ¸…å•

### åŸºç¡€åŠŸèƒ½æµ‹è¯•

#### 1. å¯åŠ¨æµ‹è¯•
```bash
# å¯åŠ¨æœåŠ¡
python3 app.py

# æ£€æŸ¥è¾“å‡º
# åº”è¯¥æ˜¾ç¤º:
# ğŸ¬ åª’ä½“åº“æ–‡ä»¶ç®¡ç†å™¨ V1.3
# æœåŠ¡å™¨è¿è¡Œåœ¨: http://localhost:8090
```

#### 2. è®¿é—®æµ‹è¯•
```bash
# æµ‹è¯•Webè®¿é—®
curl http://localhost:8090

# åº”è¯¥è¿”å›HTMLå†…å®¹
```

#### 3. APIæµ‹è¯•
```bash
# æµ‹è¯•è®¾ç½®API
curl -X POST http://localhost:8090/api/get-settings \
  -H "Content-Type: application/json" \
  -d '{}'

# åº”è¯¥è¿”å›JSONé…ç½®
```

### æ–‡ä»¶æ“ä½œæµ‹è¯•

#### 1. æƒé™æµ‹è¯•
```bash
# åˆ›å»ºæµ‹è¯•ç›®å½•
mkdir -p ~/test-media/å¾…æ•´ç†
mkdir -p ~/test-media/ç”µå½±
mkdir -p ~/test-media/å‰§é›†

# åˆ›å»ºæµ‹è¯•æ–‡ä»¶
touch ~/test-media/å¾…æ•´ç†/test.mp4

# æ£€æŸ¥æƒé™
ls -la ~/test-media/
```

#### 2. æ‰«ææµ‹è¯•
- åœ¨Webç•Œé¢é…ç½®è·¯å¾„
- ç‚¹å‡»æ‰«æ
- æ£€æŸ¥æ˜¯å¦èƒ½æ‰¾åˆ°æ–‡ä»¶

#### 3. é‡å‘½åæµ‹è¯•
- ä½¿ç”¨å°‘é‡æµ‹è¯•æ–‡ä»¶
- æ‰§è¡Œé‡å‘½å
- æ£€æŸ¥ç»“æœ

### ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿæµ‹è¯•

#### NFSæµ‹è¯•
```bash
# æŒ‚è½½NFS
sudo mount -t nfs server:/export /mnt/nfs

# æµ‹è¯•è¯»å†™
touch /mnt/nfs/test.txt
rm /mnt/nfs/test.txt
```

#### SMB/CIFSæµ‹è¯•
```bash
# æŒ‚è½½SMB
sudo mount -t cifs //server/share /mnt/smb \
  -o username=user,password=pass

# æµ‹è¯•è¯»å†™
touch /mnt/smb/test.txt
rm /mnt/smb/test.txt
```

---

## ğŸ”§ å¸¸è§é—®é¢˜ä¿®å¤

### é—®é¢˜1: æƒé™é”™è¯¯

```bash
# ä¿®æ”¹æ‰€æœ‰è€…
sudo chown -R $USER:$USER /path/to/media

# ä¿®æ”¹æƒé™
sudo chmod -R 755 /path/to/media

# æ£€æŸ¥SELinuxï¼ˆCentOS/RHELï¼‰
sudo setenforce 0  # ä¸´æ—¶ç¦ç”¨
sudo getenforce    # æ£€æŸ¥çŠ¶æ€
```

### é—®é¢˜2: ç«¯å£è¢«å ç”¨

```bash
# æŸ¥æ‰¾å ç”¨è¿›ç¨‹
sudo lsof -i :8090
# æˆ–
sudo netstat -tulpn | grep 8090

# ä¿®æ”¹ç«¯å£
# ç¼–è¾‘ app.py
PORT = 8091  # æ”¹ä¸ºå…¶ä»–ç«¯å£
```

### é—®é¢˜3: Pythonç‰ˆæœ¬è¿‡ä½

```bash
# Ubuntu/Debian
sudo apt update
sudo apt install python3.9

# CentOS/RHEL
sudo yum install python39

# ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬
python3.9 app.py
```

### é—®é¢˜4: é…ç½®æ–‡ä»¶æƒé™

```bash
# æ£€æŸ¥é…ç½®ç›®å½•
ls -la ~/.media-renamer/

# ä¿®å¤æƒé™
chmod 755 ~/.media-renamer
chmod 644 ~/.media-renamer/config.json
```

### é—®é¢˜5: ç½‘ç»œè¶…æ—¶

```python
# ç¼–è¾‘ app.py
NETWORK_RETRY_COUNT = 5  # å¢åŠ é‡è¯•æ¬¡æ•°
NETWORK_RETRY_DELAY = 3  # å¢åŠ å»¶è¿Ÿ
NETWORK_OP_DELAY = 2.0   # å¢åŠ æ“ä½œå»¶è¿Ÿ
```

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. æ‰¹é‡å¤„ç†
- æ¯æ¬¡å¤„ç†50-100ä¸ªæ–‡ä»¶
- å¤§æ–‡ä»¶ï¼ˆ>10GBï¼‰å•ç‹¬å¤„ç†
- é¿å…åŒæ—¶å¤„ç†è¿‡å¤šæ–‡ä»¶

### 2. ç½‘ç»œä¼˜åŒ–
- ä½¿ç”¨æœ‰çº¿è¿æ¥
- é¿å…WiFiè¿æ¥å¤„ç†å¤§æ–‡ä»¶
- è€ƒè™‘ä½¿ç”¨æœ¬åœ°ç¼“å­˜

### 3. ç³»ç»Ÿä¼˜åŒ–
```bash
# å¢åŠ æ–‡ä»¶æè¿°ç¬¦é™åˆ¶
ulimit -n 4096

# æ£€æŸ¥ç£ç›˜IO
iostat -x 1

# æ£€æŸ¥ç½‘ç»œ
iftop
```

### 4. NASä¼˜åŒ–
- å¯ç”¨SSDç¼“å­˜ï¼ˆå¦‚æ”¯æŒï¼‰
- ä½¿ç”¨å¿«ç…§åŠŸèƒ½å¤‡ä»½
- å®šæœŸæ¸…ç†æ—¥å¿—

---

## ğŸ”’ å®‰å…¨å»ºè®®

### 1. ç½‘ç»œå®‰å…¨
```bash
# ä»…å…è®¸å±€åŸŸç½‘è®¿é—®
sudo ufw allow from 192.168.1.0/24 to any port 8090

# æˆ–ä½¿ç”¨iptables
sudo iptables -A INPUT -s 192.168.1.0/24 -p tcp --dport 8090 -j ACCEPT
sudo iptables -A INPUT -p tcp --dport 8090 -j DROP
```

### 2. æ–‡ä»¶æƒé™
```bash
# é™åˆ¶é…ç½®æ–‡ä»¶æƒé™
chmod 600 ~/.media-renamer/config.json

# é™åˆ¶åº”ç”¨ç›®å½•æƒé™
chmod 750 /path/to/media-renamer
```

### 3. åå‘ä»£ç†ï¼ˆå¯é€‰ï¼‰
```nginx
# Nginxé…ç½®
server {
    listen 80;
    server_name media.example.com;
    
    location / {
        proxy_pass http://localhost:8090;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        
        # åŸºç¡€è®¤è¯
        auth_basic "Restricted";
        auth_basic_user_file /etc/nginx/.htpasswd;
    }
}
```

---

## ğŸ“ ç»´æŠ¤å»ºè®®

### æ—¥å¸¸ç»´æŠ¤

#### 1. æ—¥å¿—æ£€æŸ¥
```bash
# systemdæœåŠ¡æ—¥å¿—
sudo journalctl -u media-renamer -f

# ç›´æ¥è¿è¡Œæ—¥å¿—
# æŸ¥çœ‹ç»ˆç«¯è¾“å‡º
```

#### 2. é…ç½®å¤‡ä»½
```bash
# å¤‡ä»½é…ç½®
cp ~/.media-renamer/config.json ~/config.backup.json

# å®šæœŸå¤‡ä»½
crontab -e
# æ·»åŠ : 0 0 * * 0 cp ~/.media-renamer/config.json ~/backups/config-$(date +\%Y\%m\%d).json
```

#### 3. æ›´æ–°æ£€æŸ¥
```bash
# æ£€æŸ¥æ›´æ–°
git pull

# é‡å¯æœåŠ¡
sudo systemctl restart media-renamer
```

### å®šæœŸä»»åŠ¡

#### 1. æ¸…ç†æ—¥å¿—
```bash
# æ¸…ç†æ—§æ—¥å¿—
sudo journalctl --vacuum-time=7d
```

#### 2. æ£€æŸ¥ç£ç›˜ç©ºé—´
```bash
# æ£€æŸ¥ç©ºé—´
df -h

# æ¸…ç†ç¼“å­˜
sudo apt clean  # Ubuntu/Debian
sudo yum clean all  # CentOS/RHEL
```

#### 3. æ›´æ–°Cookie
- æ¯æœˆæ›´æ–°è±†ç“£Cookie
- æ£€æŸ¥TMDB API KeyçŠ¶æ€

---

## âœ… éƒ¨ç½²å®Œæˆæ£€æŸ¥

éƒ¨ç½²å®Œæˆåï¼Œç¡®è®¤ä»¥ä¸‹é¡¹ç›®ï¼š

- [ ] Python 3.6+ å·²å®‰è£…
- [ ] æœåŠ¡æ­£å¸¸å¯åŠ¨
- [ ] Webç•Œé¢å¯è®¿é—®
- [ ] APIå¯†é’¥å·²é…ç½®
- [ ] è·¯å¾„æƒé™æ­£ç¡®
- [ ] æµ‹è¯•æ–‡ä»¶å¤„ç†æˆåŠŸ
- [ ] æ—¥å¿—æ­£å¸¸è¾“å‡º
- [ ] é˜²ç«å¢™å·²é…ç½®
- [ ] å¤‡ä»½ç­–ç•¥å·²è®¾ç½®
- [ ] æ–‡æ¡£å·²é˜…è¯»

---

## ğŸ‰ éƒ¨ç½²æˆåŠŸ

æ­å–œï¼ç³»ç»Ÿå·²æˆåŠŸéƒ¨ç½²å¹¶ä¼˜åŒ–å®Œæˆã€‚

ç°åœ¨ä½ å¯ä»¥ï¼š
1. è®¿é—® http://your-ip:8090
2. é…ç½®APIå¯†é’¥
3. å¼€å§‹æ•´ç†åª’ä½“åº“

äº«å—è‡ªåŠ¨åŒ–çš„åª’ä½“ç®¡ç†ä½“éªŒï¼
