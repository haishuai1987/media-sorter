# é”™è¯¯å¤„ç†è¯´æ˜ (v1.7.0)

## æ¦‚è¿°

v1.7.0 å¼•å…¥äº†ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æ¡†æ¶ï¼Œæä¾›ï¼š
- ğŸ”„ è‡ªåŠ¨é‡è¯•æœºåˆ¶
- ğŸ›¡ï¸ é”™è¯¯åˆ†ç±»å’Œæ¢å¤
- ğŸ’¬ ç”¨æˆ·å‹å¥½çš„é”™è¯¯æ¶ˆæ¯
- ğŸ“Š é”™è¯¯ç»Ÿè®¡å’Œç›‘æ§

## æ ¸å¿ƒåŠŸèƒ½

### 1. é”™è¯¯åˆ†ç±»

ç³»ç»Ÿè‡ªåŠ¨å°†é”™è¯¯åˆ†ä¸ºä»¥ä¸‹ç±»å‹ï¼š
- **ç½‘ç»œé”™è¯¯** - è¶…æ—¶ã€è¿æ¥å¤±è´¥ç­‰
- **APIé”™è¯¯** - 401ã€403ã€429ã€500ç­‰
- **æ–‡ä»¶é”™è¯¯** - æ–‡ä»¶ä¸å­˜åœ¨ã€æƒé™ä¸è¶³ç­‰
- **æƒé™é”™è¯¯** - è®¿é—®è¢«æ‹’ç»
- **éªŒè¯é”™è¯¯** - è¾“å…¥æ ¼å¼ä¸æ­£ç¡®
- **è¶…æ—¶é”™è¯¯** - æ“ä½œè¶…æ—¶

### 2. è‡ªåŠ¨é‡è¯•

å¯¹äºå¯æ¢å¤çš„é”™è¯¯ï¼ˆå¦‚ç½‘ç»œè¶…æ—¶ï¼‰ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨é‡è¯•ï¼š

```python
from error_handler import retry_on_error

@retry_on_error(max_retries=3, delay=1.0, backoff=2.0)
def network_request():
    # ä½ çš„ç½‘ç»œè¯·æ±‚ä»£ç 
    pass
```

**ç‰¹æ€§ï¼š**
- æœ€å¤šé‡è¯•3æ¬¡
- æŒ‡æ•°é€€é¿ï¼ˆ1ç§’ â†’ 2ç§’ â†’ 4ç§’ï¼‰
- æ™ºèƒ½åˆ¤æ–­æ˜¯å¦åº”è¯¥é‡è¯•

### 3. å®‰å…¨æ‰§è¡Œ

æ•è·æ‰€æœ‰å¼‚å¸¸ï¼Œé¿å…ç¨‹åºå´©æºƒï¼š

```python
from error_handler import safe_execute

success, result, error = safe_execute(
    lambda: risky_operation(),
    default_value=None,
    operation='é£é™©æ“ä½œ'
)

if not success:
    print(f"æ“ä½œå¤±è´¥: {error}")
```

### 4. é”™è¯¯æ¢å¤

æä¾›é¢„å®šä¹‰çš„æ¢å¤ç­–ç•¥ï¼š

```python
from error_handler import ErrorRecovery

# ç½‘ç»œé”™è¯¯æ¢å¤ï¼ˆè‡ªåŠ¨é‡è¯•ï¼‰
success, result = ErrorRecovery.recover_from_network_error(
    network_function,
    arg1,
    arg2
)

# æ–‡ä»¶é”™è¯¯æ¢å¤ï¼ˆæ•è·å¸¸è§æ–‡ä»¶é”™è¯¯ï¼‰
success, result = ErrorRecovery.recover_from_file_error(
    file_function,
    filepath
)
```

## å‹å¥½é”™è¯¯æ¶ˆæ¯

ç³»ç»Ÿä¼šå°†æŠ€æœ¯é”™è¯¯è½¬æ¢ä¸ºç”¨æˆ·å‹å¥½çš„æ¶ˆæ¯ï¼š

| åŸå§‹é”™è¯¯ | å‹å¥½æ¶ˆæ¯ |
|---------|---------|
| `Connection timeout` | ç½‘ç»œè¿æ¥è¶…æ—¶ï¼Œè¯·æ£€æŸ¥ç½‘ç»œåé‡è¯• |
| `HTTP 401` | Cookieå·²è¿‡æœŸæˆ–æ— æ•ˆï¼Œè¯·é‡æ–°ç™»å½• |
| `HTTP 429` | è¯·æ±‚è¿‡äºé¢‘ç¹ï¼Œè¯·ç¨åå†è¯• |
| `Permission denied` | æ²¡æœ‰æƒé™è®¿é—®æ–‡ä»¶æˆ–ç›®å½• |
| `File not found` | æ–‡ä»¶ä¸å­˜åœ¨ |

## ä½¿ç”¨åœºæ™¯

### åœºæ™¯1: TMDB APIè°ƒç”¨

```python
@retry_on_error(max_retries=3, delay=1.0)
def search_movie(title):
    # TMDBæœç´¢
    # ç½‘ç»œé”™è¯¯ä¼šè‡ªåŠ¨é‡è¯•
    pass
```

### åœºæ™¯2: 115ç½‘ç›˜æ‰¹é‡æ“ä½œ

```python
def batch_rename(files):
    success_count = 0
    failed = []
    
    for file_id, new_name in files.items():
        try:
            rename_file(file_id, new_name)
            success_count += 1
        except Exception as e:
            # è®°å½•é”™è¯¯ä½†ç»§ç»­å¤„ç†
            error_msg = ErrorHandler.get_friendly_message(e)
            failed.append((file_id, error_msg))
    
    return success_count, failed
```

### åœºæ™¯3: æ–‡ä»¶æ‰«æ

```python
def scan_directory(path):
    success, files, error = safe_execute(
        lambda: os.listdir(path),
        default_value=[],
        operation=f'æ‰«æç›®å½• {path}'
    )
    
    if not success:
        print(f"æ‰«æå¤±è´¥: {error}")
        return []
    
    return files
```

## é”™è¯¯ç»Ÿè®¡

æŸ¥çœ‹é”™è¯¯ç»Ÿè®¡ä¿¡æ¯ï¼š

```python
# APIé”™è¯¯ç»Ÿè®¡
stats = api_client.get_error_stats()
print(f"é”™è¯¯æ¬¡æ•°: {stats['error_count']}")
print(f"æœ€åé”™è¯¯: {stats['last_error']}")

# æ€§èƒ½ç»Ÿè®¡
perf = api_client.get_performance_stats()
print(f"è¯·æ±‚æ¬¡æ•°: {perf['request_count']}")
print(f"é”™è¯¯ç‡: {perf['error_rate']:.2%}")
```

## é…ç½®é€‰é¡¹

åœ¨é…ç½®æ–‡ä»¶ä¸­å¯ç”¨è¯¦ç»†æ—¥å¿—ï¼š

```json
{
  "debug_mode": true,
  "error_log_level": "verbose"
}
```

## æœ€ä½³å®è·µ

1. **ç½‘ç»œæ“ä½œ** - ä½¿ç”¨ `@retry_on_error` è£…é¥°å™¨
2. **æ‰¹é‡æ“ä½œ** - æ•è·å•ä¸ªé”™è¯¯ï¼Œç»§ç»­å¤„ç†å…¶ä»–é¡¹
3. **æ–‡ä»¶æ“ä½œ** - ä½¿ç”¨ `safe_execute` æˆ– `ErrorRecovery`
4. **ç”¨æˆ·æç¤º** - ä½¿ç”¨ `get_friendly_message` è·å–å‹å¥½æ¶ˆæ¯
5. **é”™è¯¯æ—¥å¿—** - ä½¿ç”¨ `log_error` è®°å½•è¯¦ç»†ä¿¡æ¯

## æ€§èƒ½å½±å“

- é”™è¯¯å¤„ç†å¼€é”€ï¼š< 1ms
- é‡è¯•å»¶è¿Ÿï¼šå¯é…ç½®ï¼ˆé»˜è®¤1ç§’èµ·ï¼‰
- å†…å­˜å ç”¨ï¼šæå°ï¼ˆ< 1MBï¼‰

## å…¼å®¹æ€§

- âœ… å®Œå…¨å‘åå…¼å®¹
- âœ… ä¸å½±å“ç°æœ‰åŠŸèƒ½
- âœ… å¯é€‰å¯ç”¨

## ç¤ºä¾‹ä»£ç 

å®Œæ•´ç¤ºä¾‹è¯·å‚è€ƒï¼š
- `error_handler.py` - æ ¸å¿ƒæ¨¡å—
- `test_error_handler.py` - æµ‹è¯•ç”¨ä¾‹
- `error_handler_integration.py` - é›†æˆç¤ºä¾‹

## å¸¸è§é—®é¢˜

**Q: å¦‚ä½•ç¦ç”¨è‡ªåŠ¨é‡è¯•ï¼Ÿ**  
A: è®¾ç½® `max_retries=0`

**Q: å¦‚ä½•è‡ªå®šä¹‰é”™è¯¯æ¶ˆæ¯ï¼Ÿ**  
A: ä¿®æ”¹ `ErrorHandler.ERROR_MESSAGES` å­—å…¸

**Q: å¦‚ä½•æ·»åŠ æ–°çš„é”™è¯¯ç±»å‹ï¼Ÿ**  
A: åœ¨ `ErrorType` æšä¸¾ä¸­æ·»åŠ æ–°ç±»å‹

**Q: é‡è¯•ä¼šå½±å“æ€§èƒ½å—ï¼Ÿ**  
A: åªæœ‰åœ¨é”™è¯¯å‘ç”Ÿæ—¶æ‰ä¼šé‡è¯•ï¼Œæ­£å¸¸æƒ…å†µä¸‹æ— å½±å“

## æ›´æ–°æ—¥å¿—

è¯¦è§ `CHANGELOG-v1.7.0.md`
